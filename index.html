<!DOCTYPE html>
<html lang="en-US" class="no-js">
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />

  <head>
    <meta
      name="robots"
      content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"
    />

    <title>TBRR</title>

    <link
      rel="stylesheet"
      id="combined-css"
      href="tbrr public/Main/tbrr/css/combined.min662c.css?ver=2024.22.02.01"
      media="all"
    />
    <link
      rel="stylesheet"
      id="kmain/tbrr-style-css"
      href="tbrr public/Main/tbrr/style8a54.css?ver=1.0.0"
      media="all"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css"
    />

    <link rel="stylesheet" href="./tbrr public/Main/tbrr/css/tbrr custom.css" />
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="./tbrr public/Main/tbrr/css/bootstrap.min.css"
    />
    <!-- Fontawesome -->
    <link rel="stylesheet" href="tbrr public/Main/tbrr/css/fontawesome.css" />
    <!-- Flaticon -->
    <link rel="stylesheet" href="tbrr public/Main/tbrr/css/flaticon.css" />
    <!-- optico Icons -->
    <link
      rel="stylesheet"
      href="tbrr public/Main/tbrr/css/pbminfotech-base-icons.css"
    />
    <!-- Themify Icons -->
    <link rel="stylesheet" href="tbrr public/Main/tbrr/css/themify-icons.css" />
    <!-- Base CSS -->
    <link rel="stylesheet" href="tbrr public/Main/tbrr/css/base.css" />
    <!-- Style CSS -->
    <link rel="stylesheet" href="tbrr public/Main/tbrr/css/style.css" />
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="tbrr public/Main/tbrr/css/responsive.css" />

    <!-- hhh -->

    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="images/homepage-1/favicon.png"
    />

    <style>
      #map {
        height: 900px;
      }

      .leaflet-popup-content {
        max-height: 300px;
        overflow-y: auto;
      }

      .list-container,
      .pbmit-all-post-list {
        font-size: 10px;
        font-weight: bold;
        font-family: PPNeueMontreal-Medium, sans-serif;
      }

      .active-region,
      .active-woreda,
      .active-kebele,
      .active-site {
        background-color: rgb(0, 96, 74);
        color: white;
      }

      .s-lists {
        border: 1px solid rgb(206, 210, 200);
        border-radius: 5px;
        box-shadow: 0 0 5px 0 rgba(0, 0, 0, 0.1);
      }

      .s-content .s-search {
        position: relative;
      }

      .s-search i {
        position: absolute;
        line-height: 30px;
        color: #999;
        left: 10px;
      }

      .s-search input {
        width: 100%;
        outline: none;
        font-size: 11px;
        font-weight: 400;
        padding: 5px 15px 5px 40px;
        border: solid 1px rgb(133, 200, 33);
        border-radius: 5px;
      }

      .s-content ul {
        margin-top: 10px;
        max-height: 200px;
        overflow-y: auto;
      }

      .s-content ul::-webkit-scrollbar {
        width: 5px;
      }

      .s-content ul::-webkit-scrollbar-track {
        background-color: #f1f1f1;
        border-radius: 20px;
        margin: 5px 3px;
      }

      .s-content ul::-webkit-scrollbar-thumb {
        background-color: #ccc;
        border-radius: 20px;
      }

      .s-content ul li:hover {
        background-color: #f2f2f2;
        color: #000;
      }

      .s-hide {
        display: none;
      }

      .Nav {
        display: flex;
        align-items: center;
      }

      .logo {
        margin-right: 5%;
      }

      .navigation {
        display: flex;
        padding-left: 5px;
        padding-right: 5px;
        flex-wrap: wrap;
      }

      .mini-nav {
        padding-left: 10px;
        padding-right: 10px;
        width: fit-content;
        margin: 10px;
      }
  .nav-trigger {
    width: 20px;
}
    .fixed-nav-wrapper {
      width: 300px;
    }
      .accordion-content {
        display: none;
        background-color: white;
        position: absolute;
        width: 150px;
      }

      .accordion-active {
        display: block;
      }
    </style>
  </head>
  <body
    class="home page-template-default page page-id-9 header-over-content no-sidebar"
  >

  <div class="loading-container"></div>

    <header>
      <div class="container-fluid native-padding">
        <div class="row">
          <div class="Nav">
            <a href="/">
              <div class="logo-full">
                <img
                  src="tbrr public/Main/tbrr/img/tbrrlogo/tbrrlogo1.jpg"
                  height="45px"
                  width="45px"
                  alt=" Logo"
                />
                Tree based Restoration Registry
              </div>
            </a>
            <div class="navigation">
              <a href="/" class="mini-nav">
                <div>Interactive map</div>
              </a>
              <a href="Aboutr.html" class="mini-nav">
                <div>About the Registry</div>
              </a>
              <a href="Aboutsf.html" class="mini-nav">
                <div>About the Fund</div>
              </a>
              <a href="/" class="mini-nav" id="faq">
                <div>FAQ</div>
              </a>
              <a href="/" class="mini-nav">
                <div>Contact</div>
              </a>
            </div>
          </div>
        </div>
      </div>
    </header>

    <div class="fixed-nav-wrapper">
      <div class="nav-trigger" id="nav-trigger">
        <span>Filters</span><i></i>
      </div>
    </div>

    <div id="main-nav-overlay-wrapper" class="container-fluid px-0 is-active">
      <div class="row mx-0 d-flex align-content-end overlay-inner">
        <div
          class="col-12 h-100 px-0 d-flex flex-column flex-nowrap mobile-nav-outer"
        >
          <div class="top-item-wrapper mt-sidebar-5">
            <div class="card card-body">
              <div class="row g-1">
                <div class="col-md-3">
                  <div
                    class="container region-container px-5 pt-2 wrapper"
                    id="regionContainer"
                  >
                    <div
                      class="d-flex justify-content-between align-content-center arrow"
                      id="selectBtn"
                    >
                      <h6>Select region</h6>
                      <i class="fa fa-caret-down pt-2"></i>
                    </div>
                    <div class="s-content">
                      <div class="s-search">
                        <i class="fa fa-search"></i>
                        <input
                          type="text"
                          placeholder="Search"
                          id="searchInput"
                        />
                      </div>
                      <ul
                        class="pbmit-all-post-list container s-lists"
                        id="regionList"
                      ></ul>
                    </div>
                  </div>
                </div>

                <div class="col-md-3">
                  <div
                    class="container woreda-container px-5 pt-2"
                    id="woredaContainer"
                  >
                    <div class="s-hide arrow" id="woredaBtn">
                      <h6>Select woreda</h6>
                    </div>
                    <div class="s-content s-hide" id="woredaContent">
                      <div class="s-search">
                        <i class="fa fa-search"></i>
                        <input
                          type="text"
                          placeholder="Search"
                          id="woredaInput"
                        />
                      </div>
                      <ul
                        class="pbmit-all-post-list container s-lists"
                        id="woredaList"
                      ></ul>
                    </div>
                  </div>
                </div>

                <div class="col-md-3">
                  <div
                    class="container kebele-container px-5 pt-2"
                    id="kebeleContainer"
                    style="display: none"
                  >
                    <div class="arrow">
                      <h6>Select kebele</h6>
                    </div>
                    <div class="s-content" id="woredaContent">
                      <div class="s-search">
                        <i class="fa fa-search"></i>
                        <input
                          type="text"
                          placeholder="Search"
                          id="kebeleInput"
                        />
                      </div>
                      <ul
                        class="pbmit-all-post-list container s-lists"
                        id="kebeleList"
                      ></ul>
                    </div>
                  </div>
                </div>

                <div class="col-md-3">
                  <div
                    class="container site-container px-5 pt-2"
                    id="siteContainer"
                    style="display: none"
                  >
                    <div class="arrow">
                      <h6>Select site</h6>
                    </div>
                    <div class="s-content" id="woredaContent">
                      <div class="s-search">
                        <i class="fa fa-search"></i>
                        <input
                          type="text"
                          placeholder="Search"
                          id="siteInput"
                        />
                      </div>
                      <ul
                        class="pbmit-all-post-list container s-lists"
                        id="siteList"
                      ></ul>
                    </div>
                  </div>
                </div>
              </div>
              <br />
            </div>
            <br />
            <div class="container project-container">
              <div class="card">
                <div class="card-header">
                  <h6 class="card-title">Detailed location Information</h6>
                </div>
                <div
                  class="card-body overflow-auto projectInfo"
                  style="height: 400px"
                >
                  Explore detailed location information by selecting a region
                  and other criteria using the filters above. Simply click on
                  the filter navigation to refine your search and access
                  comprehensive data.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br /><br /><br />

    <div class="content-wrapper">
      <br />
      <div class="row">
        <div class="col-12 col-sm-10 col-md-8 col-xl-12">
          <div class="intro-title">
            <h2 class="m-lg-5">
              Welcome to <span>Tree based Restoration Registry (TBRR)</span>
            </h2>
          </div>
          <div class="col-12 col-sm-12 col-md-12 col-xl-10 m-lg-5">
            This web-based interactive map and database serve as a guide to
            pinpointing degraded sites across Ethiopia. Here, you'll find a
            wealth of detailed information essential for identifying,
            monitoring, and rehabilitating these landscapes, playing a pivotal
            role in environmental restoration and fostering long-term
            sustainability.
          </div>
        </div>
      </div>
      <br /><br />
      <div class="row">
        <div class="col-md-9">
          <img
            src="tbrr public/Main/tbrr/img/icons/zoom-out.png"
            height="30px"
            id="Zoom_Out"
            alt="Zoom Out Icon"
          />
          <div id="map"></div>
        </div>
        <div class="col-md-3 mt-5">
          <div class="container project-container">
            <div class="card">
              <div class="card-header">
                <h6 class="card-title">Detailed location Information</h6>
              </div>
              <div
                class="card-body overflow-auto projectInfo"
                style="height: 800px"
              >
                Explore detailed location information by selecting a region and
                other criteria using the filters above. Simply click on the
                filter navigation to refine your search and access comprehensive
                data.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br />

    <footer>
      <div class="container-fluid native-padding">
        <div class="row">
          <div class="col-12">
            <div class="footer-top">
              <div class="row">
                <div class="col-xl-12">
                  <div>
                    <h6 class="strong">Disclaimer</h6>
                    <p class="indented smaller">
                      The information presented on the registry is sourced from
                      various stakeholders within Ethiopia, including Regions,
                      Woredas, and Kebeles. While we strive for accuracy and
                      reliability, we cannot guarantee the completeness or
                      timeliness of the content. Ethiopian Forestry Development
                      (EFD) retains all rights to the information provided.
                      Reproduction or distribution of any part of the content
                      without explicit permission is prohibited. Additionally,
                      EFD is not liable for any actions taken based on the
                      information presented on the registry. Users are
                      encouraged to verify details and contact us with any
                      concerns or corrections.
                    </p>
                  </div>
                </div>
              </div>
              <a
                href="contact-kes-dckv//"
                target
                class="d-inline-block d-md-none footer-cta main-btn"
                >Get a Quote</a
              >
            </div>
          </div>
          <div class="col-12 footer-middle">
            <div class="row justify-content-between">
              <div
                class="col-12 col-sm-6 col-lg-auto footer-col-1 omit-last-item-margin"
              >
                <div class="logo-full">
                  <img
                    src="tbrr public/Main/tbrr/img/tbrrlogo/tbrrlogo1.jpg"
                    height="45px"
                    width="45px"
                    alt="Tree based Restoration Registry Logo"
                  />
                </div>
                <div class="h4 color-dark-green">
                  Tree based Restoration Registry
                </div>
                Addis Ababa, Ethiopia<br />
              </div>
              <div class="col-12 col-sm-6 col-lg-auto footer-col-2">
                <div class="h4 color-dark-green">Get in touch</div>
                <ul class="social-links">
                  <li><a href="#" target="_blank">Twitter</a></li>
                  <li><a href="#" target="_blank">LinkedIn</a></li>
                  <li><a href="#" target="_blank">Facebook</a></li>
                </ul>
              </div>
              <div class="col col-sm-6 col-lg-auto footer-col-3 pe-5 pe-md-3">
                <div class="row align-items-center justify-content-between">
                  <div class="col-12">
                    <div class="h4 color-dark-green">Resources</div>
                  </div>
                </div>
              </div>
              <div class="col-auto col-sm-6 col-lg-auto footer-col-4"></div>
            </div>
          </div>
          <div class="col-12 footer-credits">
            <div class="row justify-content-between d-flex align-items-end">
              <div class="col-lg-6">
                Tree based Restoration Registry
                <a href="#" target="_blank">TBRR</a> &copy; 2024. All rights
                reserved.
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script
      src="tbrr js/js/jquery/jquery.minf43b.js?ver=3.7.1"
      id="jquery-core-js"
    ></script>
    <script
      src="tbrr js/js/jquery/jquery-migrate.min5589.js?ver=3.4.1"
      id="jquery-migrate-js"
    ></script>
    <script
      src="tbrr public/Main/tbrr/js/combined.min662c.js?ver=2024.22.02.01"
      id="customscripts-js"
    ></script>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>

 // Display the loading animation when the page starts loading
document.addEventListener("DOMContentLoaded", function () {
  const loadingAnimation = `
    <div class="loading-spinner d-flex justify-content-center">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" width="60" height="200" style="shape-rendering: auto; display: block; background: transparent;" xmlns:xlink="http://www.w3.org/1999/xlink">
        <g>
          <circle stroke-dasharray="164.93361431346415 56.97787143782138" r="35" stroke-width="10" stroke="#00604a" fill="none" cy="50" cx="50">
            <animateTransform keyTimes="0;1" values="0 50 50;360 50 50" dur="1s" repeatCount="indefinite" type="rotate" attributeName="transform"></animateTransform>
          </circle>
        </g>
      </svg>
    </div>
     <strong>Please Wait...</strong>
  `;

  // Add the loading animation to your desired container (e.g., a div with class "loading-container")
  const loadingContainer = document.querySelector(".loading-container");
  if (loadingContainer) {
    loadingContainer.innerHTML = loadingAnimation;
  }
});

// Hide the loading animation when the page has finished loading
window.addEventListener("load", function () {
  const loadingContainer = document.querySelector(".loading-container");
  if (loadingContainer) {
    loadingContainer.style.display = "none";
  }
});


      
      const thirdOpacity = 0.1;
      const secondaryOpacity = 0.4;
      const mainOpacity = 0.0;
      const ethiopia = { lat: 9.145, lng: 40.4897 };
      const map = L.map("map", {
        minZoom: 5,
        maxBounds: [
          [3.306, 32.897], // Southwestern corner of the bounding box
          [15.003, 48.102], // Northeastern corner of the bounding box
        ],
        updateWhenIdle: false,
      }).setView(ethiopia, 7);

      L.tileLayer(
        "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",
        {
          attribution: "&copy; OpenStreetMap contributors",
        }
      ).addTo(map);

      // Helper function to fetch GeoJSON data
      function fetchData(url) {
        return fetch(url).then((response) => response.json());
      }

      fetchData("boundary.geojson").then(function (data) {
        L.geoJSON(data, {
          style: {
            fillColor: "#f8f8f8",
            fillOpacity: 1,
            color: "white",
            weight: 1,
          },
        }).addTo(map);
      });
      var regionLayer,
        allSiteLayerGroup = L.layerGroup().addTo(map);
      woredaLayerGroup = L.layerGroup().addTo(map);
      var kebeleLayerGroup = L.layerGroup().addTo(map);
      var siteLayerGroup = L.layerGroup().addTo(map);

      var All_Regions = [];
      var Woredas = [];
      var Kebeles = [];
      var Sites = [],
        Woredas_List = [],
        Kebele_List = [],
        Site_List = [],
        woredaBool = false,
        kebeleBool = false,
        siteBool = false;

      var woredaList = document.getElementById("woredaList");
      var selectWoreda = document.getElementById("woredaBtn");
      var woredaContent = document.getElementById("woredaContent");
      var kebeleList = document.getElementById("kebeleList");
      var siteList = document.getElementById("siteList");

      //https://tbrr.echnoserve.com/api/geojson/sites
      ////////////

      ///////////
      fetch("https://tbrr.echnoserve.com/api/geojson/regions")
        .then((response) => response.json())
        .then((data) => {
          const Region_Array = data.data;
          Region_Array.forEach(function (region) {
            fetchData(`https://tbrr.echnoserve.com/${region}`).then(
              (regionData) => {
                All_Regions.push(regionData);
                var regionList = document.getElementById("regionList");
                var searchInput = document.getElementById("searchInput");

                var regions = [];

                regionData.features.forEach((feature) => {
                  feature.properties.id = parseInt(region.match(/\d+/)[0], 10);
                  regions.push({
                    Name: feature.properties.name,
                    id: parseInt(region.match(/\d+/)[0], 10),
                  });
                });

                regions.forEach((region) => {
                  var listItem = document.createElement("li");
                  listItem.textContent = region.Name;
                  regionList.appendChild(listItem);

                  listItem.addEventListener("click", function () {
                    Woredas = [];
                    Kebeles = [];
                    Sites = [];

                    if (kebeleList) {
    kebeleList.style.display = "none";

}

if (siteList) {
  siteList.style.display = "none";
}

                    var selectedRegion = region.id;
                    woredaLayerGroup.clearLayers();
                    regionLayer.resetStyle();
                    var selectedLayer = getLayerByRegionName(selectedRegion);

                    if (selectedLayer) {
                      map.fitBounds(selectedLayer.getBounds());
                      selectedLayer.fire("click");
                    }
                  });
                });

                ///////////////
                searchInput.addEventListener("input", function () {
                  var filterValue = searchInput.value.toLowerCase();
                  Array.from(regionList.getElementsByTagName("li")).forEach(
                    function (listItem) {
                      var RegionName = listItem.textContent.toLowerCase();
                      if (RegionName.indexOf(filterValue) > -1) {
                        listItem.style.display = "";
                      } else {
                        listItem.style.display = "none";
                      }
                    }
                  );
                });

                all_Site = [];
                function onEachSiteLayer(feature, layer) {
                  //feature.properties.id = parseInt(region.match(/\d+/)[0], 10)

                  all_Site.push(layer);
                  var siteIcon = L.icon({
                    iconUrl: "tbrr public/Main/tbrr/icons/gps.png",
                    iconSize: [32, 32],
                    iconAnchor: [16, 16],
                  });
                  var coordinates = layer.getBounds().getCenter();
                  var siteMarker = L.marker(coordinates, {
                    icon: siteIcon,
                  }).addTo(map);

                  siteMarker.bindTooltip(
                    feature.properties.Name
                      ? feature.properties.Name
                      : feature.properties.watershed,
                    {
                      permanent: false,
                      direction: "top",
                    }
                  );

                  var SITE_ID = feature.properties.id;

                  siteMarker.on("click", function () {
                    // map.setView(coordinates, 14);
                    var THE_SITE = all_Site.find(
                      (LAYER) => LAYER.feature.properties.id === SITE_ID
                    );
                    THE_SITE.setStyle({ color: "black" });
                    map.fitBounds(THE_SITE.getBounds());
                    projectInfo(SITE_ID, "site");
                  });
                }
                ///////////////
                fetch("https://tbrr.echnoserve.com/api/geojson/sites")
                  .then((response) => response.json())
                  .then((data) => {
                    const Site_array = data.data;
                    Site_array.forEach(function fetchSiteData(site_Url) {
                      return fetch(`https://tbrr.echnoserve.com${site_Url}`)
                        .then((response) => response.json())
                        .then((data) => {
                          data.features[0].properties.id = parseInt(
                            site_Url.match(/\d+/)[0],
                            10
                          );

                          var siteLayer = L.geoJSON(data.features, {
                            onEachFeature: onEachSiteLayer,
                          });
                          // all_Site.push(siteLayer);

                          allSiteLayerGroup = L.geoJSON(data, {
                            style: {
                              fillColor: "#803d00",
                              fillOpacity: 0,
                              color: "#803d00",
                              weight: 3,
                            },
                          }).addTo(map);
                        })
                        .catch((error) =>
                          console.error("Error fetching site data:", error)
                        );
                    });
                  })
                  .catch((error) => {
                    console.error("Error:", error);
                  });

                regionLayer = L.geoJSON(All_Regions, {
                  style: {
                    color: "#009879",
                    fillOpacity: mainOpacity,
                    weight: 1,
                  },
                  onEachFeature: onEachRegionFeature,
                }).addTo(map);

                function onEachRegionFeature(feature, layer) {
                  layer.on("click", function (event) {
                    projectInfo(feature.properties.id, "region");
                    regionLayer.resetStyle();
                    event.target.setStyle({
                      color: "black",
                      fillOpacity: mainOpacity,
                      weight: 5,
                    });
                    markSelectedRegionInList(feature.properties.name);
                    woredaLayerGroup.clearLayers();
                    drawWoredasForRegion(feature.properties.id);
                    updateWoredaList(feature.properties.id);
                  });

                  function drawWoredasForRegion(selectedRegion) {
                    fetch(
                      `https://tbrr.echnoserve.com/api/geojson/regions/${selectedRegion}/woredas`
                    )
                      .then((response) => response.json())
                      .then((data) => {
                        const Region_Woredas = data.data;
                        Region_Woredas.forEach(function (woro_da) {
                          fetchData(
                            `https://tbrr.echnoserve.com/${woro_da}`
                          ).then((woredaData) => {
                            Woredas_List.push(woredaData);
                            L.geoJSON(woredaData, {
                              onEachFeature: onEachWoredaFeature,
                            }).addTo(woredaLayerGroup);
                          });
                        });
                      })
                      .catch((error) => {
                        console.error("Error:", error);
                      });
                  }
                }

                function getLayerByRegionName(regionId) {
                  var selectedLayer = null;
                  regionLayer.eachLayer(function (layer) {
                    if (layer.feature.properties.id === regionId) {
                      selectedLayer = layer;
                    }
                  });
                  return selectedLayer;
                }

                function getLayerByWoredaName(WoredaId) {
                  return Woredas.find(
                    (layer) => layer.feature.properties.id === WoredaId
                  );
                }

                function getLayerByKebeleName(KebeleName) {
                  return Kebeles.find(
                    (layer) => layer.feature.properties.name === KebeleName
                  );
                }

                function getLayerBySiteName(SiteId) {
                  var THE_SITE = all_Site.find(
                    (LAYER) => LAYER.feature.properties.id === SiteId
                  );
                  return THE_SITE;
                }

                function markSelectedRegionInList(selectedRegion) {
                  var listItems = document.querySelectorAll("li");
                  listItems.forEach(function (item) {
                    if (item.textContent === selectedRegion) {
                      item.classList.remove("active-region");
                      item.classList.add("active-region");
                    } else {
                      item.classList.remove("active-region");
                    }
                  });
                }

                function updateWoredaList(selectedRegion) {
                  var searchInput = document.getElementById("woredaInput");

                  selectWoreda.classList.remove("s-hide");
                  woredaContent.classList.remove("s-hide");
                  woredaList.innerHTML = "<strong>Woredas:</strong>";

                  fetchData(
                    `https://tbrr.echnoserve.com/api/regions/${selectedRegion}/woredas?all=false`
                  ).then((woredaData) => {
                    woredaData.data.forEach((Woreda_Data) => {
                      var listItem = document.createElement("li");
                      listItem.textContent = Woreda_Data.woreda_name;
                      listItem.classList.add("woreda-item");
                      listItem.dataset.woredaId = Woreda_Data.id;
                      woredaList.appendChild(listItem);

                      listItem.addEventListener("click", function () {
                        // var selectedWoreda = feature.properties.ADM3_EN;

                        if (kebeleList) {
    kebeleList.style.display = "block";

}  
if (siteList) {
    siteList.style.display = "none";

} 


                        var selectedWoredaId = parseInt(this.dataset.woredaId);

                        var W_layer = getLayerByWoredaName(
                          selectedWoredaId.toString()
                        );
                        if (W_layer) {
                          map.fitBounds(W_layer.getBounds());
                          W_layer.setStyle({
                            color: "black",
                            fillOpacity: secondaryOpacity,
                            weight: 1,
                          });
                          W_layer.fire("click");
                        }

                        woredaLayerGroup.eachLayer(function (woredaLayer) {
                          woredaLayer.setStyle({
                            color: "#803d00",
                            fillOpacity: thirdOpacity,
                            weight: 1,
                          });
                        });

                        woredaLayerGroup.eachLayer(function (woredaLayer) {
                          if (
                            woredaLayer.feature &&
                            woredaLayer.feature.properties.id ===
                              W_layer.feature.properties.id
                          ) {
                            woredaLayer.setStyle({
                              color: "#803d00",
                              fillOpacity: mainOpacity,
                              weight: 1,
                            });
                            // Center map on the selected woreda
                            map.fitBounds(woredaLayer.getBounds());
                            woredaLayer.fire("click");
                          }
                        });
                        // console.log("W_layer.feature.properties.name",W_layer.feature.properties.name)
                        markSelectedWoredaInList(
                          W_layer.feature.properties.name
                        );
                        kebeleLayerGroup.clearLayers();
                        drawKebelesForWoreda(W_layer.feature.properties.id);
                      });
                    });

                    // Filter/Search functionality
                    searchInput.addEventListener("input", function () {
                      var filterValue = searchInput.value.toLowerCase();
                      Array.from(woredaList.getElementsByTagName("li")).forEach(
                        function (listItem) {
                          var woredaName = listItem.textContent.toLowerCase();
                          if (woredaName.indexOf(filterValue) > -1) {
                            listItem.style.display = "";
                          } else {
                            listItem.style.display = "none";
                          }
                        }
                      );
                    });
                  });

                  showContainer("woredaContainer", "woredaList");
                }
                function drawKebelesForWoreda(selectedWoreda) {
                  fetch(
                    `https://tbrr.echnoserve.com/api/geojson/woredas/${selectedWoreda}/kebeles`
                  )
                    .then((response) => response.json())
                    .then((data) => {
                      const Woroda_Kebeles = data.data;
                      Woroda_Kebeles.forEach(function (KEBELE) {
                        fetchData(`https://tbrr.echnoserve.com${KEBELE}`).then(
                          (woredaData) => {
                            woredaData.features.forEach((feature) => {
                              feature.properties.id = parseInt(
                                KEBELE.match(/\d+/)[0],
                                10
                              );
                            });

                            L.geoJSON(woredaData, {
                              onEachFeature: onEachKebeleFeature,
                            }).addTo(kebeleLayerGroup);
                          }
                        );
                      });
                    })
                    .catch((error) => {
                      console.error("Error:", error);
                    });
                }

                function onEachKebeleFeature(feature, layer) {
                  Kebeles.push(layer);
                  layer.on("click", function () {
                    kebeleLayerGroup.eachLayer(function (kebeleLayer) {
                      kebeleLayer.setStyle({
                        color: "#6c757d",
                        fillOpacity: mainOpacity,
                        weight: 1,
                      });
                    });

                    layer.setStyle({
                      color: "#4CAF50",
                      fillOpacity: secondaryOpacity,
                      weight: 1,
                    });
                    ``;
                    console.log("keb layer", feature, layer);
                    projectInfo(feature.properties.id, "kebele");

                    markSelectedKebeleInList(feature.properties.name);

                    // Center map on the selected kebele
                    map.fitBounds(layer.getBounds());

                    siteLayerGroup.clearLayers();
                    //  drawSitesForKebele(feature.properties.RK_CODE);
                    //updateSiteList(feature.properties.RK_CODE);
                  });
                }

                function markSelectedKebeleInList(selectedKebele) {
                  var kebeleItems = document.querySelectorAll("#kebeleList li");
                  kebeleItems.forEach(function (item) {
                    var kebeleName = item.textContent.trim();
                    if (kebeleName === selectedKebele) {
                      item.classList.remove("active-kebele");
                      item.classList.add("active-kebele");
                    } else {
                      item.classList.remove("active-kebele");
                    }
                  });
                }

                function updateKebeleList(selectedWoreda) {
                  var searchInput = document.getElementById("kebeleInput");

                  kebeleList.innerHTML = "<strong>Kebeles:</strong>";
                  ////////////
                  // fetchData(`https://tbrr.echnoserve.com/api/woredas/${selectedWoreda}/kebeles?all=false`).then((woredaData) => {
                  // woredaData.data
                  ////////////
                  fetchData(
                    `https://tbrr.echnoserve.com/api/woredas/${selectedWoreda}/kebeles?all=false`
                  ).then((kebeleData) => {
                    kebeleData.data.forEach((feature) => {
                      var listItem = document.createElement("li");
                      listItem.textContent = feature.kebele_name;
                      kebeleList.appendChild(listItem);

                      listItem.dataset.kebeleName = feature.kebele_name;
                      listItem.dataset.kebeleId = feature.id;
                      listItem.addEventListener("click", function () {

                        if (siteList) {
  siteList.style.display = "block";
}

                        var selectedKebeleId = parseInt(this.dataset.kebeleId);
                        markSelectedKebeleInList(feature.kebele_name);

                        var selectedKebeleName = this.dataset.kebeleName;
                        var K_layer = getLayerByKebeleName(selectedKebeleName);
                        if (K_layer) {
                          map.fitBounds(K_layer.getBounds());
                          K_layer.setStyle({
                            color: "green",
                            fillOpacity: secondaryOpacity,
                            weight: 2,
                          });
                        }
                        projectInfo(selectedKebeleId, "kebele");
                        kebeleLayerGroup.eachLayer(function (kebeleLayer) {
                          kebeleLayer.setStyle({
                            color: "#6c757d",
                            fillOpacity: mainOpacity,
                            weight: 1,
                          });
                        });

                        kebeleLayerGroup.eachLayer(function (kebeleLayer) {
                          if (
                            kebeleLayer.feature &&
                            kebeleLayer.feature.properties.name ===
                              feature.properties.name
                          ) {
                            kebeleLayer.setStyle({
                              color: "#4CAF50",
                              fillOpacity: secondaryOpacity,
                              weight: 1,
                            });
                          }
                        });

                        siteLayerGroup.clearLayers();
                        drawSitesForKebele(selectedKebeleId.toString());
                        updateSiteList(this.dataset.kebeleId);
                      });
                    });
                  });

                  // Filter/Search functionality
                  searchInput.addEventListener("input", function () {
                    var filterValue = searchInput.value.toLowerCase();
                    Array.from(kebeleList.getElementsByTagName("li")).forEach(
                      function (listItem) {
                        var kebeleName = listItem.textContent.toLowerCase();
                        if (kebeleName.indexOf(filterValue) > -1) {
                          listItem.style.display = "";
                        } else {
                          listItem.style.display = "none";
                        }
                      }
                    );
                  });

                  showContainer("kebeleContainer", "kebeleList");
                }

                function onEachSiteFeature(feature, layer) {
                  Sites.push(layer);
                  layer.on("click", function () {
                    projectInfo(feature.id, "site");
                    siteLayerGroup.eachLayer(function (siteLayer) {
                      siteLayer.setStyle({
                        color: "#ffd700",
                        fillOpacity: mainOpacity,
                        weight: 1,
                      });
                    });

                    layer.setStyle({
                      color: "#ffd790",
                      fillOpacity: secondaryOpacity,
                      weight: 1,
                    });

                    markSelectedSiteInList(feature.site_name);
                    map.fitBounds(layer.getBounds());
                    // Center map on the selected site
                  });
                }

                function markSelectedSiteInList(selectedSite) {
                  var siteItems = document.querySelectorAll("#siteList li");
                  siteItems.forEach(function (item) {
                    var siteName = item.textContent.trim();
                    if (siteName === selectedSite) {
                      item.classList.remove("active-site");
                      item.classList.add("active-site");
                    } else {
                      item.classList.remove("active-site");
                    }
                  });
                }

                function drawSitesForKebele(selectedkebele) {
                  fetch(
                    `https://tbrr.echnoserve.com/api/geojson/kebeles/${selectedkebele}/sites`
                  )
                    .then((response) => response.json())
                    .then((data) => {
                      const Woroda_Kebeles = data.data;
                      Woroda_Kebeles.forEach(function (SITE) {
                        fetchData(`https://tbrr.echnoserve.com${SITE}`).then(
                          (siteData) => {
                            L.geoJSON(siteData, {
                              onEachFeature: onEachSiteFeature,
                            }).addTo(siteLayerGroup);
                          }
                        );
                      });
                    })
                    .catch((error) => {
                      console.error("Error:", error);
                    });
                }
                function updateSiteList(selectedKebele) {
                  var siteList = document.getElementById("siteList");
                  siteList.innerHTML = "<strong>Sites:</strong>";

                  fetchData(
                    `https://tbrr.echnoserve.com/api/kebeles/${selectedKebele}/sites?all=false`
                  ).then((siteData) => {
                    siteData.data.forEach((feature) => {
                      var listItem = document.createElement("li");
                      listItem.textContent =
                        feature.site_name ?? feature.watershed_name;
                      listItem.dataset.siteId = feature.id;
                      listItem.dataset.name = feature.site_name;
                      siteList.appendChild(listItem);

                      listItem.addEventListener("click", function () {
                        projectInfo(feature.id, "site");
                        siteLayerGroup.eachLayer(function (siteLayer) {
                          if (
                            siteLayer.feature &&
                            siteLayer.feature.properties.Name ===
                              feature.site_name
                          ) {
                            siteLayer.setStyle({
                              color: "#ffd790",
                              fillOpacity: secondaryOpacity,
                              weight: 1,
                            });
                          } else {
                            map.fitBounds(siteLayer.getBounds());
                            siteLayer.setStyle({
                              color: "#ffd700",
                              fillOpacity: mainOpacity,
                              weight: 1,
                            });
                          }
                        });

                        markSelectedSiteInList(feature.site_name);
                      });
                    });
                  });
                  showContainer("siteContainer", "siteList");
                }

                function onEachWoredaFeature(feature, layer) {
                  Woredas.push(layer);

                  layer.bindTooltip(feature.properties.name, {
                    permanent: false,
                    direction: top,
                    fontSize: "16px",
                  });
                  layer.on("click", function () {
                    projectInfo(feature.properties.id, "woreda");
                    woredaLayerGroup.eachLayer(function (woredaLayer) {
                      woredaLayer.setStyle({
                        color: "#803d00",
                        fillOpacity: thirdOpacity,
                        weight: 1,
                      });
                    });

                    layer.setStyle({
                      color: "#803d00",
                      fillOpacity: mainOpacity,
                      weight: 1,
                    });

                    markSelectedWoredaInList(feature.properties.name);

                    // Center map on the selected woreda
                    map.fitBounds(layer.getBounds());

                    kebeleLayerGroup.clearLayers();
                    drawKebelesForWoreda(feature.properties.id);
                    updateKebeleList(feature.properties.id);
                  });
                }

                function markSelectedWoredaInList(selectedWoreda) {
                  var woredaItems = document.querySelectorAll("#woredaList li");
                  woredaItems.forEach(function (item) {
                    var woredaName = item.textContent.trim();
                    if (woredaName === selectedWoreda) {
                      item.classList.remove("active-woreda");
                      item.classList.add("active-woreda");
                    } else {
                      item.classList.remove("active-woreda");
                    }
                  });
                }
              }
            );
          });
        })
        .catch((error) => {
          console.error("Error:", error);
        });

      var Zoom_Out = document.getElementById("Zoom_Out");
      Zoom_Out.addEventListener("click", function () {
        map.setView(ethiopia, 7);
      });

      async function RegionData(id) {
        try {
          const response = await fetch(
            `https://tbrr.echnoserve.com/api/regions/${id}`
          );
          const data = await response.json();
          return data.data;
        } catch (error) {
          console.error("Error fetching data:", error);
          throw error; // Propagate the error further if needed
        }
      }

      async function Woreda_Data(id) {
        try {
          const response = await fetch(
            `https://tbrr.echnoserve.com/api/woredas/${id}`
          );
          const data = await response.json();
          return data.data;
        } catch (error) {
          console.error("Error fetching data:", error);
          throw error;
        }
      }

      async function Kebele_Data(id) {
        try {
          const response = await fetch(
            `https://tbrr.echnoserve.com/api/kebeles/${id}`
          );
          const data = await response.json();
          return data.data;
        } catch (error) {
          console.error("Error fetching data:", error);
          throw error;
        }
      }

      async function Site_Data(id) {
        try {
          const response = await fetch(
            `https://tbrr.echnoserve.com/api/sites/${id}`
          );
          const data = await response.json();
          return data.data;
        } catch (error) {
          console.error("Error fetching data:", error);
          throw error;
        }
      }

      async function Get_Coordinates(geoJSON) {
        try {
          const response = await fetch(`https://tbrr.echnoserve.com${geoJSON}`);
          const data = await response.json();
          return data.features[0].geometry.coordinates[0][0];
        } catch (error) {
          console.error("Error fetching geoJSON:", error);
          throw error;
        }
      }
      async function projectInfo(id, type) {
        const projectInfoDiv = document.getElementsByClassName("projectInfo");

        const loadingAnimation = `
        <div class="loading-spinner d-flex justify-content-center">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" width="60" height="200" style="shape-rendering: auto; display: block; background: transparent;" xmlns:xlink="http://www.w3.org/1999/xlink"><g><circle stroke-dasharray="164.93361431346415 56.97787143782138" r="35" stroke-width="10" stroke="#00604a" fill="none" cy="50" cx="50">
            <animateTransform keyTimes="0;1" values="0 50 50;360 50 50" dur="1s" repeatCount="indefinite" type="rotate" attributeName="transform"></animateTransform>
          </circle><g></g></g></svg>
        </div>
    `;

        // Set the content to the loading animation
        for (let i = 0; i < projectInfoDiv.length; i++) {
          projectInfoDiv[i].innerHTML = loadingAnimation;
        }
        let content = "";

        const renderTableRows = (rows) =>
          rows
            .map(
              (row) => `
        <tr>
            <td class="border px-4 py-2 font-bold">${row.label}</td>
            <td class="border px-4 py-2">${row.value}</td>
        </tr>
    `
            )
            .join("");


            const resourceTables = (resources, resourceName) => `
                <h4>${resourceName}</h4>
                <hr />

                <table class="table-auto w-full">
                    <tbody>${resources
                      .map(
                        (resource, index) => `
                        <tr key=${index}>
                            <td class="border px-4 py-2 font-bold">${resource.value}</td>
                            <td class="border px-4 py-2">${resource.amount}</td>
                        </tr>
                    `
                      )
                      .join("")}</tbody>
                </table>
                <hr />
            `;


//             const resourceTables = (resources, title) => {
//     if (!resources || resources.length === 0) return '';

//     const tableRows = resources[0].map(resource => `
//         <tr>
//           ${console.log("hdjchdssdddddddddddddshdgcsdjk",resource)}

//             <td class="border px-4 py-2 font-bold">${resource.value}</td>
//             ${resource.amount ? `<td class="border px-4 py-2">${resource.amount}</td>` : ''}
//         </tr>
//     `).join('');

//     return `
//         <h4>${title}</h4>
//         <hr />
//         <table class="table-auto w-full">
//             <tbody>${tableRows}</tbody>
//         </table>
//     `;
// };
        try {
          if (type === "region") {
            const regionData = await RegionData(id);
            const rows = [
              { label: "Region Name", value: regionData.region_name },
              { label: "Region Code", value: regionData.region_code },
              { label: "Number of Sites", value: regionData.sites },
              { label: "Number of Kebeles", value: regionData.kebeles.length },
              { label: "Number of Woredas", value: regionData.woredas.length },
            ];

            content = `
                <h4>${regionData.region_name}</h4>
                <hr />
                <table class="table-auto w-full">
                    <tbody>${renderTableRows(rows)}</tbody>
                </table>
            `;
          } else if (type === "woreda") {
            const woredaData = await Woreda_Data(id);
            const dataRows = [
              {
                label: "Female Population",
                value: woredaData.woreda_data?.female_population !== undefined ? woredaData.woreda_data.female_population : 'No data',
              },
              {
                label: "Male Population",
                value: woredaData.woreda_data?.male_population !== undefined ? woredaData.woreda_data.male_population : 'No data',
              },
              {
                label: "Rural Kebeles",
                value: woredaData.woreda_data?.rural_kebeles !== undefined ? woredaData.woreda_data.rural_kebeles : 'No data',
              },
              {
                label: "Urban Kebeles",
                value: woredaData.woreda_data?.urban_kebeles !== undefined ? woredaData.woreda_data.urban_kebeles : 'No data',
              },
            ];


            content = `
                <h4>${woredaData.woreda_name}</h4>
                <hr />
                <table class="table-auto w-full">
                    <tbody>${renderTableRows([
                      { label: "Woreda Name", value:woredaData.woreda_name !== undefined ? woredaData.woreda_name : 'No data'},
                      { label: "Woreda Code", value:woredaData.woreda_code !== undefined ? woredaData.woreda_code : 'No data' },
                      { label: "Region Name", value:woredaData.region_name !== undefined ? woredaData.region_name : 'No data' },
                      { label: "Zone Name", value:woredaData.zone_name !== undefined ? woredaData.zone_name : 'No data' },

                    ])}</tbody>
                </table>
                <hr/>
                <h6>Woreda Data</h6>
                <hr/>
                <table class="table-auto w-full">
                    <tbody>${renderTableRows(dataRows)}</tbody>
                </table>
                <hr />
                <h4>Woreda Resource</h4>
                <hr />
                ${woredaData.woreda_resource.length !== 0 ? resourceTables(woredaData.woreda_resource?.LAND, "LAND"): ''}
                ${woredaData.woreda_resource.length !== 0 ? resourceTables(woredaData.woreda_resource?.ROAD, "ROAD"): ''}
                ${ woredaData.woreda_institution.length !== 0 ? resourceTables(
                  woredaData.woreda_institution?.SCHOOL,
                  "School"
                ): ''}
                ${ woredaData.woreda_institution.length !== 0 ? resourceTables(
                  woredaData.woreda_institution?.HEALTH_FACILITY,
                  "Health Facility"
                ): ''}
            `;
          } else if (type === "site") {
            const siteData = await Site_Data(id);
            const coordinates = await Get_Coordinates(siteData.geojson);

            content = `
                <h4>${siteData.site_name}</h4>
                <hr />
                <h6>Site Information</h6>
                <p><strong>Size in Ha.: </strong> ${siteData.size_ha !== undefined ? siteData.size_ha: 'No data'}</p>
                <p><strong>Watershed: </strong> ${siteData.watershed_name !== undefined ?siteData.watershed_name: 'No data'}</p>
                <p><strong>Kebele: </strong> ${siteData.kebele_name !== undefined ?siteData.kebele_name: 'No data'}</p>
                <p><strong>Woreda: </strong> ${
                  siteData.woreda_name || "Adwa"
                }</p>
                <p><strong>Zone: </strong> ${siteData.zone_name || "N/A"}</p>
                <h4>Site Resource</h4>
                <hr />
                <strong>Current land use</strong>
                <hr />
                ${siteData.resources
                  ?.map((resource) =>
                    resource.LAND?.map(
                      (item) => `
                    <div key=${item.index}>
                        <p class="border px-4 py-2 font-bold">${item.value}</p>
                    </div>
                `
                    ).join("")
                  )
                  .join("")}
                <strong>TREE</strong>
                <hr />
                <p class="font-bold">Indigenous Tree</p>
                ${siteData.resources
                  ?.map((resource) =>
                    resource.TREE?.filter((tree) => tree.indigenous === 1)
                      .map(
                        (item) => `
                    <div key=${item.index}>
                        <p class="border px-4 py-2 font-bold">${item.value}</p>
                    </div>
                `
                      )
                      .join("")
                  )
                  .join("")}
                <p class="font-bold">Exotic Tree</p>
                <hr />
                ${siteData.resources
                  ?.map((resource) =>
                    resource.TREE?.filter(
                      (tree) => !tree.hasOwnProperty("indigenous")
                    )
                      .map(
                        (item) => `
                    <div key=${item.index}>
                        <p class="border px-4 py-2 font-bold">${item.value}</p>
                    </div>
                `
                      )
                      .join("")
                  )
                  .join("")}
                <strong>LIVESTOCK</strong>
                <hr />
                ${siteData.resources
                  ?.map((resource) =>
                    resource.LIVESTOCK?.map(
                      (item) => `
                    <div key=${item.index}>
                        <p class="border px-4 py-2 font-bold">${item.value}</p>
                    </div>
                `
                    ).join("")
                  )
                  .join("")}
                <strong>FORAGE</strong>
                <hr />
                ${siteData.resources
                  ?.map((resource) =>
                    resource.FORAGE?.map(
                      (item) => `
                    <div key=${item.index}>
                        <p class="border px-4 py-2 font-bold">${item.value}</p>
                    </div>
                `
                    ).join("")
                  )
                  .join("")}
                <strong>Coordinates</strong>
                <hr/>
                <table class="table-auto w-full">
                    <thead>
                        <th>Latitude</th>
                        <th>Longitude</th>
                    </thead>
                    <tbody>${coordinates
                      .map(
                        (coords, index) => `
                        <tr key=${index}>
                            <td class="border px-4 py-2 font-bold">${coords[0]}</td>
                            <td class="border px-4 py-2">${coords[1]}</td>
                        </tr>
                    `
                      )
                      .join("")}</tbody>
                </table>
            `;
          }else if (type === "kebele") {
    const kebeleData = await Kebele_Data(id);
    console.log("kebeleData:", kebeleData);

    const dataRows = [
        { label: "Female Population", value: kebeleData.kebele_data.female_population },
        { label: "Male Population", value: kebeleData.kebele_data.male_population },
        { label: "Female Non-Employed", value: kebeleData.kebele_data.female_non_employed },
        { label: "Male Non-Employed", value: kebeleData.kebele_data.male_non_employed },
        { label: "MHF Land Owners", value: kebeleData.kebele_data.mhf_land_owners },
        { label: "FHF Land Owners", value: kebeleData.kebele_data.fhf_land_owners },
        { label: "MHF Land Lease", value: kebeleData.kebele_data.mhf_land_lease },
        { label: "FHF Land Lease", value: kebeleData.kebele_data.fhf_land_lease },
    ];

    const resourceTables = (resources, resourceName) => {
    if (!Array.isArray(resources)) return '';

    const hasAmount = resources.some(resource => resource.amount !== undefined);
    const hasCapacity = resources.some(resource => resource.capacity !== undefined);

    return `
        <h4>${resourceName}</h4>
        <hr />
        <table class="table-auto w-full">
            <thead>
                <tr>
                    <th class="px-4 py-2"></th>
                    ${hasAmount ? '<th class="px-4 py-2 font-bold text-lg">Amount</th>' : ''}
                    ${hasCapacity ? '<th class="px-4 py-2 font-bold text-lg">Capacity</th>' : ''}
                </tr>
            </thead>
            <tbody>
                ${resources.map((resource, index) => `
                    <tr key=${index}>
                        <td class="border px-4 py-2 font-bold">${resource.value}</td>
                        ${hasAmount ? `<td class="border px-4 py-2">${resource.amount || 'No data'}</td>` : ''}
                        ${hasCapacity ? `<td class="border px-4 py-2">${resource.capacity || 'No data'}</td>` : ''}
                    </tr>
                `).join('')}
            </tbody>
        </table>
        <hr />
    `;
};

    const livelihoodTable = (livelihoods) => {
        if (!Array.isArray(livelihoods)) return '';

        return `
            <h4>Livelihoods</h4>
            <hr />
            <table class="table-auto w-full">
                <thead>
                    <tr>
                        <th class=" px-4 py-2 font-bold text-lg">Type</th>
                        <th class=" px-4 py-2 font-bold text-lg">Male Headed HH</th>
                        <th class=" px-4 py-2 font-bold text-lg">Female Headed HH</th>
                    </tr>
                </thead>
                <tbody>${livelihoods.map((livelihood, index) => `
                    <tr key=${index}>
                        <td class="border px-4 py-2 font-bold">${livelihood.value}</td>
                        <td class="border px-4 py-2">${livelihood.male_headed_hh}</td>
                        <td class="border px-4 py-2">${livelihood.female_headed_hh}</td>
                    </tr>
                `).join("")}</tbody>
            </table>
            <hr />
        `;
    };

    const energyResourcesTable = (energy_resources) => {
        if (!Array.isArray(energy_resources)) return '';

        
        return `
            <h4>Energy Resources</h4>
            <hr />
            <table class="table-auto w-full">
                <thead>
                    <tr>
                        <th class="px-4 py-2 font-bold text-lg">Type</th>
                        <th class="px-4 py-2 font-bold text-lg">Access Level</th>
                    </tr>
                </thead>
                <tbody>${energy_resources.map((resource, index) => `
                    <tr key=${index}>
                        <td class="border px-4 py-2 font-bold">${resource.value}</td>
                        <td class="border px-4 py-2">${resource.access_level}</td>
                    </tr>
                `).join("")}</tbody>
            </table>
            <hr />
        `;
    };

    const renderResourceTables = (resources) => {
        return resources.map(resourceObj => {
            const resourceType = Object.keys(resourceObj)[0];
            if (resourceType === "TREE") {
                const indigenousTrees = resourceObj[resourceType].filter(tree => tree.indigenous);
                const exoticTrees = resourceObj[resourceType].filter(tree => !tree.indigenous);
                return `
                    ${resourceTables(indigenousTrees, "Indigenous Trees")}
                    ${resourceTables(exoticTrees, "Exotic Trees")}
                `;
            } else {
                return resourceTables(resourceObj[resourceType], resourceType);
            }
        }).join('');
    };

    content =`
          <h4>${kebeleData.kebele_name}</h4>
        <hr />
        <table class="table-auto w-full">
            <tbody>${renderTableRows([
                { label: "Region Name", value: kebeleData.region_name },
                { label: "Woreda Name", value: kebeleData.woreda_name },
                { label: "Zone Name", value: kebeleData.zone_name },
            ])}</tbody>
        </table>
        <hr/>
        <h6>Kebele Data</h6>
        <hr/>
        <table class="table-auto w-full">
            <tbody>${renderTableRows(dataRows)}</tbody>
        </table>
        <hr />
        ${renderResourceTables(kebeleData.resources)}
        ${livelihoodTable(kebeleData.livelihoods)}
        ${energyResourcesTable(kebeleData.energy_sources)}
    `;
}


  
          for (let i = 0; i < projectInfoDiv.length; i++) {
            projectInfoDiv[i].innerHTML = content;
          }
        } catch (error) {
          console.error("Error:", error);
        }
      }

      function showContainer(containerId, listId) {
        var container = document.getElementById(containerId);
        var list = document.getElementById(listId);

        if (container && list && list.children.length > 0) {
          container.style.display = "block";
        } else {
          container.style.display = "none";
        }
      }
    </script>
  </body>
</html>
